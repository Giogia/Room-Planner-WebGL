{"version":3,"file":"images-4-up.js","sourceRoot":"","sources":["../../../../src/test/fidelity/components/images-4-up.ts"],"names":[],"mappings":"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","sourcesContent":["/* @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport '../image-accessor.js';\nimport './magnifying-glass.js';\n\nimport {html, LitElement, property} from 'lit-element';\n\nimport {Dimensions, Pixel, Rect} from '../common.js';\n\nimport {ImageAccessor} from '../image-accessor.js';\n\n\nexport class Images4Up extends LitElement {\n  @property({type: Object}) topLeftImageAccessor: ImageAccessor|null = null;\n  @property({type: Object}) topRightImageAccessor: ImageAccessor|null = null;\n  @property({type: Object}) bottomLeftImageAccessor: ImageAccessor|null = null;\n  @property({type: Object}) bottomRightImageAccessor: ImageAccessor|null = null;\n\n  @property({type: Object}) magnifiedPixel: Pixel|null = null;\n  @property({type: Object}) dimensions: Dimensions = {width: 0, height: 0};\n\n  @property({type: Object})\n  protected containerRect: Rect = {x: 0, y: 0, width: 0, height: 0};\n\n  localCoordinateToImagePixel(localX: number, localY: number): Pixel {\n    const constrainedX = Math.min(\n        Math.max(localX - this.containerRect.x, -1),\n        this.containerRect.width + 1);\n    const constrainedY = Math.min(\n        Math.max(localY - this.containerRect.y, -1),\n        this.containerRect.height + 1);\n\n    const scaledWidth = this.containerRect.width / 2;\n    const scaledHeight = this.containerRect.height / 2;\n\n    const scale = this.dimensions.width / scaledWidth;\n\n    return {\n      x: Math.floor((constrainedX % scaledWidth) * scale),\n      y: Math.floor((constrainedY % scaledHeight) * scale)\n    };\n  }\n\n  protected selectPixel(pixel: Pixel) {\n    this.magnifiedPixel = pixel;\n    this.dispatchEvent(new CustomEvent('select-pixel', {detail: pixel}));\n  }\n\n  onPointerEvent(event: PointerEvent) {\n    const pixel = this.localCoordinateToImagePixel(event.x, event.y);\n\n    if (pixel.x > -1 && pixel.x < this.dimensions.width && pixel.y > -1 &&\n        pixel.y < this.dimensions.height) {\n      this.selectPixel(pixel);\n    } else {\n      this.magnifiedPixel = null;\n    }\n  }\n\n  connectedCallback() {\n    super.connectedCallback && super.connectedCallback();\n    self.addEventListener('resize', (_event) => this.updateSize());\n  }\n\n  updateSize() {\n    const rect = this.getBoundingClientRect();\n    const {width: containerWidth, height: containerHeight} = rect;\n    const fourUpWidth = 2 * this.dimensions.width;\n    const fourUpHeight = 2 * this.dimensions.height;\n\n    const containerAspectRatio = containerWidth / containerHeight;\n    const fourUpAspectRatio = fourUpWidth / fourUpHeight;\n\n    const scale = fourUpAspectRatio < containerAspectRatio ?\n        containerHeight / fourUpHeight :\n        containerWidth / fourUpWidth;\n\n    const width = scale * fourUpWidth;\n    const height = scale * fourUpHeight;\n\n    const x = (containerWidth - width) / 2;\n    const y = (containerHeight - height) / 2;\n\n    this.containerRect = {x, y, width, height};\n  }\n\n  async updated(changedProperties: Map<string, any>) {\n    super.updated(changedProperties);\n\n    if (changedProperties.has('dimensions') && this.dimensions != null) {\n      this.updateSize();\n\n      this.selectPixel({\n        x: Math.floor(this.dimensions.width / 2),\n        y: Math.floor(this.dimensions.height / 2)\n      });\n    }\n  }\n\n  render() {\n    const {x, y, width, height} = this.containerRect;\n\n    return html`\n<style>\n:host {\n  display: block;\n  position: relative;\n}\n\nmagnifying-glass {\n  flex: 1 1 50%;\n  width: 50%;\n  height: 50%;\n}\n\n#container {\n  display: flex;\n  cursor: crosshair;\n  position: absolute;\n  flex-direction: row;\n  flex-wrap: wrap;\n  align-items: flex-start;\n  justify-content: flex-start;\n}\n\n#magnifier-button {\n  position: absolute;\n  top: 0;\n  right: 0;\n}\n</style>\n<div id=\"container\"\n    @pointermove=\"${(event: PointerEvent) => this.onPointerEvent(event)}\"\n    @pointerdown=\"${(event: PointerEvent) => this.onPointerEvent(event)}\"\n    style=\"transform: translate(${x}px, ${y}px);\n           width: ${width}px;\n           height: ${height}px\">\n  <magnifying-glass id=\"top-left\"\n      .pixel=\"${this.magnifiedPixel}\"\n      .imageAccessor=\"${this.topLeftImageAccessor}\">\n    <slot name=\"top-left\"></slot>\n  </magnifying-glass>\n  <magnifying-glass id=\"top-right\"\n      .pixel=\"${this.magnifiedPixel}\"\n      .imageAccessor=\"${this.topRightImageAccessor}\">\n    <slot name=\"top-right\"></slot>\n  </magnifying-glass>\n  <magnifying-glass id=\"bottom-left\"\n      .pixel=\"${this.magnifiedPixel}\"\n      .imageAccessor=\"${this.bottomLeftImageAccessor}\">\n    <slot name=\"bottom-left\"></slot>\n  </magnifying-glass>\n  <magnifying-glass id=\"bottom-right\"\n      .pixel=\"${this.magnifiedPixel}\"\n      .imageAccessor=\"${this.bottomRightImageAccessor}\">\n    <slot name=\"bottom-right\"></slot>\n  </magnifying-glass>\n</div>`;\n  }\n}\n\ncustomElements.define('images-4-up', Images4Up);\n"]}