{"version":3,"file":"renderer-harness.js","sourceRoot":"","sources":["../../../../src/test/fidelity/components/renderer-harness.ts"],"names":[],"mappings":"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","sourcesContent":["/* @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {css, customElement, html, LitElement, property} from 'lit-element';\n\nimport {ImageComparisonConfig, ScenarioConfig} from '../common.js';\nimport {ConfigReader} from '../config-reader.js';\n\n@customElement('renderer-harness')\nexport class RendererConfiguration extends LitElement {\n  @property({type: String, attribute: 'scenario-name'})\n  scenarioName: string|null = null;\n\n  @property({type: String, attribute: 'config-url'})\n  configUrl: string|null = null;\n\n  @property({type: Boolean, attribute: 'hide-ui'}) hideUi: boolean = false;\n\n  @property({type: Object}) protected config: ImageComparisonConfig|null = null;\n\n  @property({type: Object}) protected scenario: ScenarioConfig|null = null;\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    const {queryParameters} = this;\n    this.configUrl = queryParameters.config || '../../config.json';\n    this.scenarioName = queryParameters.scenario || null;\n    this.hideUi = 'hide-ui' in queryParameters || false;\n  }\n\n  protected get queryParameters(): {[index: string]: string} {\n    return self.location.search.slice(1).split('&').reduce(\n        (queryParameters, parameter) => {\n          const [key, value] = parameter.split('=');\n          queryParameters[key] = decodeURIComponent(value);\n          return queryParameters;\n        },\n        {} as {[index: string]: string});\n  }\n\n  async updated(changedProperties: Map<string, any>) {\n    super.updated(changedProperties);\n\n    if (changedProperties.has('configUrl')) {\n      if (this.configUrl == null) {\n        this.config = null;\n      } else {\n        this.config = await (await fetch(this.configUrl)).json()\n      }\n    }\n\n    if (changedProperties.has('scenarioName') ||\n        changedProperties.has('config')) {\n      if (this.scenarioName == null || this.config == null) {\n        this.scenario = null;\n      } else {\n        this.scenario =\n            (new ConfigReader(this.config)).scenarioConfig(this.scenarioName);\n        this.dispatchEvent(new CustomEvent(\n            'scenario-change', {detail: {scenario: this.scenario}}));\n      }\n\n      const previousScenarioName = changedProperties.get('scenarioName');\n\n      if (previousScenarioName != null && this.scenarioName != null) {\n        const url = new URL(window.location.toString());\n        url.search = url.search.replace(\n            `scenario=${encodeURIComponent(previousScenarioName)}`,\n            `scenario=${encodeURIComponent(this.scenarioName)}`);\n        history.pushState(null, document.title, url.toString());\n      }\n    }\n  }\n\n  static get styles() {\n    return css`\n:host {\n  display: flex;\n  flex-direction: column;\n  font-family: system-ui, sans-serif;\n  color: #fafafa;\n}\n\n#widgets {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n  background-color: #444;\n  padding: 0 1em;\n  min-height: 4em;\n}\n\n#widgets > * {\n  margin-right: 1em;\n}\n\n#widgets.hidden {\n  display: none;\n}\n\n#renderer {\n  max-width: 100%;\n  overflow: auto;\n}\n`;\n  }\n\n  render() {\n    const widgets = [];\n\n    if (this.config != null) {\n      const scenarioOptions = this.config.scenarios.map(\n          scenario => html`<option ?selected=\"${\n              scenario.name === this.scenarioName}\">${scenario.name}</option>`);\n      widgets.push(html`\n<select @change=\"${\n          (event: Event) => this.scenarioName =\n              (event.target != null ?\n                   (event.target as HTMLSelectElement).value :\n                   this.scenarioName)}\">\n  ${scenarioOptions}\n</select>`);\n    }\n\n    return html`\n<div id=\"widgets\" class=\"${this.hideUi ? 'hidden' : ''}\">\n  <h2><slot name=\"title\"></slot></h2>\n  ${widgets}\n</div>\n<div id=\"renderer\" .style=\"${this.hideUi ? 'overflow: visible' : ''}\">\n  <slot name=\"renderer\"></slot>\n</div>\n`;\n  }\n}"]}