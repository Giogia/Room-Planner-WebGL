{"version":3,"file":"controls-spec.js","sourceRoot":"","sources":["../../../src/test/features/controls-spec.ts"],"names":[],"mappings":"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","sourcesContent":["/* @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {IS_IE11} from '../../constants.js';\nimport {$controls, $promptAnimatedContainer, $promptElement, CameraChangeDetails, cameraOrbitIntrinsics, ControlsInterface, ControlsMixin, INTERACTION_PROMPT, SphericalPosition} from '../../features/controls.js';\nimport ModelViewerElementBase, {$canvas, $scene} from '../../model-viewer-base.js';\nimport {StyleEvaluator} from '../../styles/evaluators.js';\nimport {ChangeSource, SmoothControls} from '../../three-components/SmoothControls.js';\nimport {Constructor} from '../../utilities.js';\nimport {assetPath, dispatchSyntheticEvent, rafPasses, timePasses, until, waitForEvent} from '../helpers.js';\nimport {BasicSpecTemplate} from '../templates.js';\nimport {settleControls} from '../three-components/SmoothControls-spec.js';\n\nconst expect = chai.expect;\nconst DEFAULT_FOV = 45;\nconst ASTRONAUT_GLB_PATH = assetPath('Astronaut.glb');\n\nconst interactWith = (element: HTMLElement) => {\n  dispatchSyntheticEvent(element, 'mousedown', {clientX: 0, clientY: 10});\n  dispatchSyntheticEvent(element, 'mousemove', {clientX: 0, clientY: 0});\n};\n\nconst expectSphericalsToBeEqual =\n    (sphericalOne: SphericalPosition, sphericalTwo: SphericalPosition) => {\n      const precision = 5;\n\n      expect(sphericalOne.theta.toFixed(precision))\n          .to.be.equal(\n              sphericalTwo.theta.toFixed(precision),\n              'Spherical theta does not match');\n\n      expect(sphericalOne.phi.toFixed(precision))\n          .to.be.equal(\n              sphericalTwo.phi.toFixed(precision),\n              'Spherical phi does not match');\n\n      expect(sphericalOne.radius.toFixed(precision))\n          .to.be.equal(\n              sphericalTwo.radius.toFixed(precision),\n              'Spherical radius does not match');\n    };\n\nsuite('ModelViewerElementBase with ControlsMixin', () => {\n  suite('when registered', () => {\n    let nextId = 0;\n    let tagName: string;\n    let ModelViewerElement:\n        Constructor<ModelViewerElementBase&ControlsInterface>;\n\n    setup(() => {\n      tagName = `model-viewer-controls-${nextId++}`;\n      ModelViewerElement = class extends ControlsMixin\n      (ModelViewerElementBase) {\n        static get is() {\n          return tagName;\n        }\n      };\n      customElements.define(tagName, ModelViewerElement);\n    });\n\n    BasicSpecTemplate(() => ModelViewerElement, () => tagName);\n\n    suite('camera-orbit', () => {\n      let element: ModelViewerElementBase&ControlsInterface;\n      let controls: SmoothControls;\n      let defaultRadius: number;\n\n      setup(async () => {\n        element = new ModelViewerElement();\n        controls = (element as any)[$controls];\n        document.body.appendChild(element);\n        element.src = assetPath('cube.gltf');\n\n        await waitForEvent(element, 'load');\n        // NOTE(cdata): Sometimes the load event dispatches quickly enough to\n        // cause a race condition where property change occurs _after_ load.\n        // In this condition, it is possible for the controls to be \"unsettled\"\n        // by the time that the test begins. Awaiting for a microtask ensures\n        // that we always have time for one internal property change in the\n        // element:\n        await timePasses();\n\n        settleControls(controls);\n\n        const orbitIntrinsics = cameraOrbitIntrinsics(element);\n        const evaluator = new StyleEvaluator([], orbitIntrinsics);\n\n        defaultRadius = evaluator.evaluate()[2];\n      });\n\n      teardown(() => {\n        if (element.parentNode != null) {\n          element.parentNode.removeChild(element);\n        }\n      });\n\n      test('defaults radius to ideal camera distance', () => {\n        expect(element.getCameraOrbit().radius).to.be.equal(defaultRadius);\n      });\n\n      // TODO(#583)\n      test.skip('can independently adjust azimuth', async () => {\n        const orbit = element.getCameraOrbit();\n        const nextTheta = orbit.theta + 1.0;\n\n        element.cameraOrbit =\n            `${nextTheta}rad ${orbit.phi}rad ${orbit.radius}m`;\n\n        await timePasses();\n\n        settleControls(controls);\n\n        expectSphericalsToBeEqual(\n            element.getCameraOrbit(), {...orbit, theta: nextTheta});\n      });\n\n      test('can independently adjust inclination', async () => {\n        const orbit = element.getCameraOrbit();\n        const nextPhi = orbit.phi + 1.0;\n\n        element.cameraOrbit =\n            `${orbit.theta}rad ${nextPhi}rad ${orbit.radius}m`;\n\n        await timePasses();\n\n        settleControls(controls);\n\n        expectSphericalsToBeEqual(\n            element.getCameraOrbit(), {...orbit, phi: nextPhi});\n      });\n\n      test('can independently adjust radius', async () => {\n        const orbit = element.getCameraOrbit();\n        const nextRadius = orbit.radius - 1.0;\n\n        element.cameraOrbit =\n            `${orbit.theta}rad ${orbit.phi}rad ${nextRadius}m`;\n\n        await timePasses();\n\n        settleControls(controls);\n\n        expectSphericalsToBeEqual(\n            element.getCameraOrbit(), {...orbit, radius: nextRadius});\n\n        element.cameraOrbit = `${orbit.theta}rad ${orbit.phi}rad auto`;\n\n        await timePasses();\n        settleControls(controls);\n\n        expect(element.getCameraOrbit().radius).to.be.equal(defaultRadius);\n      });\n\n      test('can independently adjust target', async () => {\n        const target = element.getCameraTarget();\n        target.x += 1;\n        target.z += 1;\n\n        element.cameraTarget = `${target.x}m auto ${target.z}m`;\n\n        await timePasses();\n\n        settleControls(controls);\n\n        expect(element.getCameraTarget()).to.be.eql(target);\n      });\n\n      test('defaults FOV correctly', async () => {\n        expect(element.getFieldOfView()).to.be.closeTo(DEFAULT_FOV, 0.00001);\n      });\n\n      test('can independently adjust FOV', async () => {\n        const fov = element.getFieldOfView();\n        const nextFov = fov - 1.0;\n\n        element.fieldOfView = `${nextFov}deg`;\n\n        await timePasses();\n\n        settleControls(controls);\n\n        expect(element.getFieldOfView()).to.be.closeTo(nextFov, 0.00001);\n      });\n\n      test('changes FOV basis when aspect ratio changes', async () => {\n        const fov = element.getFieldOfView();\n        element.setAttribute('style', 'width: 200px; height: 300px');\n\n        await until(() => element.getFieldOfView() !== fov);\n        expect(element.getFieldOfView()).to.be.greaterThan(fov);\n      });\n\n      test('causes camera-change event to fire', async () => {\n        const cameraChangeDispatches = waitForEvent(element, 'camera-change');\n        const cameraOrbit = element.getCameraOrbit();\n        element.cameraOrbit = `${cameraOrbit.theta + 1}rad ${\n            cameraOrbit.phi}rad ${cameraOrbit.radius}m`;\n\n        await cameraChangeDispatches;\n      });\n\n      test('sets an appropriate event source', async () => {\n        const cameraChangeDispatches =\n            waitForEvent<CustomEvent<CameraChangeDetails>>(\n                element, 'camera-change');\n\n        const cameraOrbit = element.getCameraOrbit();\n        element.cameraOrbit = `${cameraOrbit.theta + 1}rad ${\n            cameraOrbit.phi}rad ${cameraOrbit.radius}m`;\n\n        const event = await cameraChangeDispatches;\n        expect(event.detail.source).to.be.equal(ChangeSource.NONE);\n      });\n\n\n      suite('getCameraOrbit', () => {\n        setup(async () => {\n          element.cameraOrbit = `1rad 1rad 1.5m`;\n          await timePasses();\n          settleControls(controls);\n        });\n\n        // NOTE(cdata): Flakey test is flakey\n        test.skip('starts at the initially configured orbit', () => {\n          const orbit = element.getCameraOrbit();\n\n          expect(`${orbit.theta}rad ${orbit.phi}rad ${orbit.radius}m`)\n              .to.be.equal(element.cameraOrbit);\n        });\n\n        test('updates with current orbit after interaction', async () => {\n          controls.adjustOrbit(0, 0.5, 0, 0);\n          settleControls(controls);\n\n          const orbit = element.getCameraOrbit();\n          expect(`${orbit.theta}rad ${orbit.phi}rad ${orbit.radius}m`)\n              .to.equal(`1rad 0.5rad 1.5m`);\n        });\n\n        test('jumpCameraToGoal updates instantly', async () => {\n          const cameraOrbit = `0.5rad 1.5rad 1.2m`;\n          element.cameraOrbit = cameraOrbit;\n          const fieldOfView = 30;\n          element.fieldOfView = `${fieldOfView}deg`;\n          element.jumpCameraToGoal();\n\n          await rafPasses();\n\n          expect(element.getFieldOfView()).to.be.closeTo(fieldOfView, 0.00001);\n          let orbit = element.getCameraOrbit();\n          // round to nearest 0.0001\n          orbit.theta = Math.round(orbit.theta * 10000) / 10000;\n          expect(`${orbit.theta}rad ${orbit.phi}rad ${orbit.radius}m`)\n              .to.equal(cameraOrbit);\n        });\n      });\n    });\n\n    suite('camera-controls', () => {\n      let element: ModelViewerElementBase&ControlsInterface;\n      let controls: SmoothControls;\n\n      setup(async () => {\n        element = new ModelViewerElement();\n        controls = (element as any)[$controls]\n        document.body.appendChild(element);\n        element.src = assetPath('cube.gltf');\n        element.cameraControls = true;\n\n        element.interactionPromptThreshold =\n            100;  // Fairly low, to keep the test time down\n\n        await waitForEvent(element, 'load');\n      });\n\n      teardown(() => {\n        element.cameraControls = false;\n        if (element.parentNode != null) {\n          element.parentNode.removeChild(element);\n        }\n      });\n\n      test('creates SmoothControls if enabled', () => {\n        expect(controls).to.be.ok;\n      });\n\n      test(\n          'requires focus to interact if policy is set to allow-when-focused',\n          async () => {\n            element.interactionPolicy = 'allow-when-focused';\n            await timePasses();\n            expect(controls.options.interactionPolicy)\n                .to.be.equal('allow-when-focused');\n          });\n\n      test(\n          'does not require focus to interact if policy is set to always-allow',\n          async () => {\n            element.interactionPolicy = 'always-allow';\n            await timePasses();\n            expect(controls.options.interactionPolicy)\n                .to.be.equal('always-allow');\n          });\n\n      test('sets max radius greater than the camera framed distance', () => {\n        const cameraDistance = element[$scene].camera.position.distanceTo(\n            element[$scene].model.position);\n        expect(controls.options.maximumRadius)\n            .to.be.greaterThan(cameraDistance);\n      });\n\n      test('disables interaction if disabled after enabled', async () => {\n        element.cameraControls = false;\n        await timePasses();\n        expect(controls.interactionEnabled).to.be.false;\n      });\n\n      suite('when user is interacting', () => {\n        test('sets an appropriate camera-change event source', async () => {\n          await rafPasses();\n          element[$canvas].focus();\n          interactWith(element[$canvas]);\n\n          const cameraChangeDispatches =\n              waitForEvent<CustomEvent<CameraChangeDetails>>(\n                  element, 'camera-change');\n          const event = await cameraChangeDispatches;\n\n          expect(event.detail.source)\n              .to.be.equal(ChangeSource.USER_INTERACTION);\n        });\n      });\n\n      suite('interaction-prompt', () => {\n        test('can be configured to never appear', async () => {\n          element.interactionPrompt = 'none';\n          await timePasses(element.interactionPromptThreshold + 100);\n\n          const promptElement: HTMLElement = (element as any)[$promptElement];\n          expect(promptElement.classList.contains('visible'))\n              .to.be.equal(false);\n        });\n\n        test('can be configured to raise automatically', async () => {\n          element.interactionPrompt = 'auto';\n          await timePasses(element.interactionPromptThreshold + 100);\n\n          const promptElement: HTMLElement = (element as any)[$promptElement];\n          expect(promptElement.classList.contains('visible')).to.be.equal(true);\n        });\n\n        test('does not appear when camera-controls is disabled', async () => {\n          element.interactionPrompt = 'auto';\n          element.cameraControls = false;\n          await timePasses(element.interactionPromptThreshold + 100);\n\n          const promptElement: HTMLElement = (element as any)[$promptElement];\n          expect(promptElement.classList.contains('visible'))\n              .to.be.equal(false);\n        });\n\n        suite('when configured to be basic', () => {\n          setup(async () => {\n            element.interactionPromptStyle = 'basic';\n            await timePasses();\n          });\n\n          test('does not have a css animation', () => {\n            const computedStyle =\n                getComputedStyle((element as any)[$promptAnimatedContainer]);\n            expect(computedStyle.animationName).to.be.equal('none');\n          });\n        });\n      });\n\n      suite('a11y', () => {\n        setup(async () => {\n          element.alt = 'A 3D model of a cube';\n          element.cameraOrbit = '0 90deg auto';\n          await rafPasses();\n        });\n\n        test(\n            'has initial aria-label set to alt before interaction',\n            async () => {\n              const canvas: HTMLCanvasElement = element[$scene].canvas;\n\n              expect(canvas.getAttribute('aria-label'))\n                  .to.be.equal(element.alt);\n            });\n\n        suite('when configured for focus-based interaction prompting', () => {\n          setup(() => {\n            element.interactionPrompt = 'when-focused';\n          });\n\n          test('prompts user to interact when focused', async () => {\n            const canvas: HTMLCanvasElement = element[$scene].canvas;\n            const promptElement: HTMLElement = (element as any)[$promptElement];\n\n            settleControls(controls);\n\n            // NOTE(cdata): This wait time was added in order to deflake tests\n            // on iOS Simulator and Android Emulator on Sauce Labs. These same\n            // test targets were tested manually locally and manually on Sauce,\n            // and do not fail. Only automated Sauce tests seem to fail\n            // consistently without this additional wait time:\n            await rafPasses();\n\n            canvas.focus();\n\n            await until(\n                () => canvas.getAttribute('aria-label') === INTERACTION_PROMPT);\n\n            expect(promptElement.classList.contains('visible'))\n                .to.be.equal(true);\n          });\n\n          test(\n              'does not prompt users to interact before a model is loaded',\n              async () => {\n                if (IS_IE11) {\n                  console.warn('Skipping this test for IE11 only');\n                  return;\n                }\n                element.src = null;\n\n                const canvas: HTMLCanvasElement = element[$scene].canvas;\n                const promptElement: HTMLElement =\n                    (element as any)[$promptElement];\n\n                await rafPasses();\n\n                canvas.focus();\n\n                await timePasses(element.interactionPromptThreshold + 100);\n\n                expect(promptElement.classList.contains('visible'))\n                    .to.be.equal(false);\n\n                canvas.blur();\n\n                element.src = ASTRONAUT_GLB_PATH;\n                await waitForEvent(element, 'load');\n\n                canvas.focus();\n\n                await until(() => promptElement.classList.contains('visible'));\n              });\n\n          // TODO(#584)\n          test.skip('does not prompt if user already interacted', async () => {\n            const canvas: HTMLCanvasElement = element[$scene].canvas;\n            const promptElement = (element as any)[$promptElement];\n            const originalLabel = canvas.getAttribute('aria-label');\n\n            expect(originalLabel).to.not.be.equal(INTERACTION_PROMPT);\n\n            canvas.focus();\n\n            interactWith(canvas);\n\n            await timePasses(element.interactionPromptThreshold + 100);\n\n            expect(canvas.getAttribute('aria-label'))\n                .to.not.be.equal(INTERACTION_PROMPT);\n            expect(promptElement.classList.contains('visible'))\n                .to.be.equal(false);\n          });\n        });\n\n        test(\n            'announces camera orientation when orbiting horizontally',\n            async () => {\n              const canvas: HTMLCanvasElement = element[$scene].canvas;\n\n              await rafPasses();\n              canvas.focus();\n\n              controls.setOrbit(-Math.PI / 2.0);\n              settleControls(controls);\n\n              expect(canvas.getAttribute('aria-label'))\n                  .to.be.equal('View from stage left');\n\n              controls.setOrbit(Math.PI / 2.0);\n              settleControls(controls);\n\n              expect(canvas.getAttribute('aria-label'))\n                  .to.be.equal('View from stage right');\n\n              controls.adjustOrbit(-Math.PI / 2.0, 0, 0, 0);\n              settleControls(controls);\n\n              expect(canvas.getAttribute('aria-label'))\n                  .to.be.equal('View from stage back');\n\n              controls.adjustOrbit(Math.PI, 0, 0, 0);\n              settleControls(controls);\n\n              expect(canvas.getAttribute('aria-label'))\n                  .to.be.equal('View from stage front');\n            });\n\n        test(\n            'announces camera orientation when orbiting vertically',\n            async () => {\n              const canvas: HTMLCanvasElement = element[$scene].canvas;\n\n              await rafPasses();\n              canvas.focus();\n\n              settleControls(controls);\n\n              controls.setOrbit(0, 0);\n              settleControls(controls);\n\n              expect(canvas.getAttribute('aria-label'))\n                  .to.be.equal('View from stage upper-front');\n\n              controls.adjustOrbit(0, -Math.PI / 2.0, 0, 0);\n              settleControls(controls);\n\n              expect(canvas.getAttribute('aria-label'))\n                  .to.be.equal('View from stage front');\n\n              controls.adjustOrbit(0, -Math.PI / 2.0, 0, 0);\n              settleControls(controls);\n\n              expect(canvas.getAttribute('aria-label'))\n                  .to.be.equal('View from stage lower-front');\n            });\n      });\n    });\n  });\n});\n"]}