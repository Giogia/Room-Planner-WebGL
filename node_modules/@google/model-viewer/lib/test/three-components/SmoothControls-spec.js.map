{"version":3,"file":"SmoothControls-spec.js","sourceRoot":"","sources":["../../../src/test/three-components/SmoothControls-spec.ts"],"names":[],"mappings":"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","sourcesContent":["/* @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Camera, PerspectiveCamera, Vector3} from 'three';\n\nimport {ChangeSource, Damper, DEFAULT_OPTIONS, KeyCode, SmoothControls} from '../../three-components/SmoothControls.js';\nimport {step} from '../../utilities.js';\nimport {dispatchSyntheticEvent, waitForEvent} from '../helpers.js';\n\nconst expect = chai.expect;\n\nconst ONE_FRAME_DELTA = 1000.0 / 60.0;\nconst FIFTY_FRAME_DELTA = 50.0 * ONE_FRAME_DELTA;\n\nconst HALF_PI = Math.PI / 2.0;\nconst QUARTER_PI = HALF_PI / 2.0;\nconst THREE_QUARTERS_PI = HALF_PI + QUARTER_PI;\n\nconst USER_INTERACTION_CHANGE_SOURCE = 'user-interaction';\nconst DEFAULT_INTERACTION_CHANGE_SOURCE = 'none';\n\n// NOTE(cdata): Precision is a bit off when comparing e.g., expected camera\n// direction in practice:\nconst FLOAT_EQUALITY_THRESHOLD = 1e-6;\n\n/**\n * Returns true if the camera is looking at a given position, within +/-\n * FLOAT_EQUALITY_THRESHOLD on each axis.\n */\nconst cameraIsLookingAt = (camera: Camera, position: Vector3) => {\n  const cameraDirection = camera.getWorldDirection(new Vector3());\n  const expectedDirection = position.clone().sub(camera.position).normalize();\n\n  const deltaX = Math.abs(cameraDirection.x - expectedDirection.x);\n  const deltaY = Math.abs(cameraDirection.y - expectedDirection.y);\n  const deltaZ = Math.abs(cameraDirection.z - expectedDirection.z);\n\n  return step(FLOAT_EQUALITY_THRESHOLD, deltaX) === 0 &&\n      step(FLOAT_EQUALITY_THRESHOLD, deltaY) === 0 &&\n      step(FLOAT_EQUALITY_THRESHOLD, deltaZ) === 0;\n};\n\n\n/**\n * Settle controls by performing 50 frames worth of updates\n */\nexport const settleControls = (controls: SmoothControls) =>\n    controls.update(performance.now(), FIFTY_FRAME_DELTA);\n\nsuite('Damper', () => {\n  let damper: Damper;\n  const initial = 5;\n  const goal = 2;\n\n  setup(() => {\n    damper = new Damper();\n  });\n\n  test('converges to goal with large time step without overshoot', () => {\n    const final = damper.update(initial, goal, FIFTY_FRAME_DELTA, initial);\n    expect(final).to.be.eql(goal);\n  });\n\n  test('stays at initial value for negative time step', () => {\n    const final = damper.update(initial, goal, -1 * FIFTY_FRAME_DELTA, initial);\n    expect(final).to.be.eql(initial);\n  });\n});\n\nsuite('SmoothControls', () => {\n  let controls: SmoothControls;\n  let camera: PerspectiveCamera;\n  let element: HTMLDivElement;\n\n  setup(() => {\n    element = document.createElement<'div'>('div');\n    camera = new PerspectiveCamera();\n    controls = new SmoothControls(camera, element);\n\n    element.style.height = '100px';\n    element.tabIndex = 0;\n\n    document.body.appendChild(element);\n\n    controls.enableInteraction();\n  });\n\n  teardown(() => {\n    document.body.removeChild(element);\n\n    controls.disableInteraction();\n  });\n\n  suite('when updated', () => {\n    test('repositions the camera within the configured radius options', () => {\n      settleControls(controls);\n\n      const radius = camera.position.length();\n\n      expect(radius).to.be.within(\n          DEFAULT_OPTIONS.minimumRadius as number,\n          DEFAULT_OPTIONS.maximumRadius as number);\n    });\n\n    test('causes the camera to look at the target', () => {\n      settleControls(controls);\n      expect(cameraIsLookingAt(camera, controls.getTarget())).to.be.equal(true);\n    });\n\n    suite('when target is modified', () => {\n      test('camera looks at the configured target', () => {\n        controls.setTarget(3, 2, 1);\n        settleControls(controls);\n\n        expect(cameraIsLookingAt(camera, controls.getTarget()))\n            .to.be.equal(true);\n      });\n    });\n\n    suite('when orbit is changed', () => {\n      suite('radius', () => {\n        test('changes the absolute distance to the target', () => {\n          settleControls(controls);\n\n          controls.setOrbit(0, HALF_PI, 1.5);\n          settleControls(controls);\n          expect(camera.position.length()).to.be.equal(1.5);\n        });\n      });\n\n      suite('azimuth', () => {\n        test('wraps and takes the shortest path', () => {\n          controls.setOrbit(QUARTER_PI);\n          settleControls(controls);\n          expect(controls.getCameraSpherical().theta).to.be.equal(QUARTER_PI);\n\n          controls.setOrbit(4 * Math.PI - HALF_PI);\n          expect(controls.getCameraSpherical().theta)\n              .to.be.closeTo(4 * Math.PI + QUARTER_PI, 0.0001);\n\n          controls.update(performance.now(), ONE_FRAME_DELTA);\n          expect(Math.abs(controls.getCameraSpherical().theta))\n              .to.be.lessThan(4 * Math.PI + QUARTER_PI);\n\n          settleControls(controls);\n          expect(controls.getCameraSpherical().theta)\n              .to.be.closeTo(4 * Math.PI - HALF_PI, 0.0001);\n\n          controls.setOrbit(THREE_QUARTERS_PI);\n          expect(controls.getCameraSpherical().theta)\n              .to.be.closeTo(Math.PI + HALF_PI, 0.0001);\n\n          controls.update(performance.now(), ONE_FRAME_DELTA);\n          expect(Math.abs(controls.getCameraSpherical().theta))\n              .to.be.lessThan(Math.PI + HALF_PI);\n\n          settleControls(controls);\n          expect(controls.getCameraSpherical().theta)\n              .to.be.closeTo(THREE_QUARTERS_PI, 0.0001);\n        });\n\n        test(\n            'adjustOrbit does not move the goal theta more than pi past the current theta',\n            () => {\n              controls.adjustOrbit(-Math.PI * 3 / 2, 0, 0, 0);\n\n              controls.update(performance.now(), ONE_FRAME_DELTA);\n              const startingTheta = controls.getCameraSpherical().theta;\n              expect(startingTheta).to.be.greaterThan(0);\n\n              controls.adjustOrbit(-Math.PI * 3 / 2, 0, 0, 0);\n              settleControls(controls);\n              const goalTheta = controls.getCameraSpherical().theta;\n              expect(goalTheta).to.be.greaterThan(Math.PI);\n              expect(goalTheta).to.be.lessThan(startingTheta + Math.PI);\n            });\n      });\n    });\n\n    suite('keyboard input', () => {\n      let initialCameraPosition: Vector3;\n\n      setup(() => {\n        settleControls(controls);\n        initialCameraPosition = camera.position.clone();\n      });\n\n      suite('global keyboard input', () => {\n        test('does not change orbital position of camera', () => {\n          dispatchSyntheticEvent(window, 'keydown', {keyCode: KeyCode.UP});\n\n          settleControls(controls);\n\n          expect(camera.position.z).to.be.equal(initialCameraPosition.z);\n        });\n      });\n\n      suite('local keyboard input', () => {\n        test('changes orbital position of camera', () => {\n          element.focus();\n\n          dispatchSyntheticEvent(element, 'keydown', {keyCode: KeyCode.UP});\n\n          settleControls(controls);\n\n          expect(camera.position.z).to.not.be.equal(initialCameraPosition.z);\n        });\n      });\n    });\n\n    suite('customizing options', () => {\n      suite('azimuth', () => {\n        setup(() => {\n          controls.applyOptions({\n            minimumAzimuthalAngle: -1 * THREE_QUARTERS_PI,\n            maximumAzimuthalAngle: THREE_QUARTERS_PI\n          });\n        });\n\n        test('prevents camera azimuth from exceeding options', () => {\n          controls.setOrbit(-Math.PI, 0, 0);\n          settleControls(controls);\n          expect(controls.getCameraSpherical().theta)\n              .to.be.equal(-1 * THREE_QUARTERS_PI);\n\n          controls.setOrbit(Math.PI, 0, 0);\n          controls.update(performance.now(), ONE_FRAME_DELTA);\n          expect(Math.abs(controls.getCameraSpherical().theta))\n              .to.be.lessThan(THREE_QUARTERS_PI);\n\n          settleControls(controls);\n          expect(controls.getCameraSpherical().theta)\n              .to.be.equal(THREE_QUARTERS_PI);\n        });\n      });\n\n      suite('pole', () => {\n        setup(() => {\n          controls.applyOptions({\n            minimumPolarAngle: QUARTER_PI,\n            maximumPolarAngle: THREE_QUARTERS_PI\n          });\n        });\n\n        test('prevents camera polar angle from exceeding options', () => {\n          controls.setOrbit(0, 0, 0);\n          settleControls(controls);\n\n          expect(controls.getCameraSpherical().phi).to.be.equal(QUARTER_PI);\n\n          controls.setOrbit(0, Math.PI, 0);\n          settleControls(controls);\n\n          expect(controls.getCameraSpherical().phi)\n              .to.be.equal(THREE_QUARTERS_PI);\n        });\n      });\n\n      suite('radius', () => {\n        setup(() => {\n          controls.applyOptions({minimumRadius: 10, maximumRadius: 20});\n        });\n\n        test('prevents camera distance from exceeding options', () => {\n          controls.setOrbit(0, 0, 0);\n          settleControls(controls);\n\n          expect(controls.getCameraSpherical().radius).to.be.equal(10);\n\n          controls.setOrbit(0, 0, 100);\n          settleControls(controls);\n\n          expect(controls.getCameraSpherical().radius).to.be.equal(20);\n        });\n      });\n\n      suite('field of view', () => {\n        setup(() => {\n          controls.applyOptions(\n              {minimumFieldOfView: 15, maximumFieldOfView: 20});\n        });\n\n        test('prevents field of view from exceeding options', () => {\n          controls.setFieldOfView(5);\n          settleControls(controls);\n\n          expect(controls.getFieldOfView()).to.be.closeTo(15, 0.00001);\n\n          controls.setFieldOfView(30);\n          settleControls(controls);\n\n          expect(controls.getFieldOfView()).to.be.closeTo(20, 0.00001);\n        });\n      });\n\n      suite('event handling', () => {\n        suite('prevent-all', () => {\n          setup(() => {\n            controls.applyOptions({\n              eventHandlingBehavior: 'prevent-all',\n              interactionPolicy: 'always-allow'\n            });\n          });\n\n          test('always preventDefaults handled, cancellable UI events', () => {\n            dispatchSyntheticEvent(element, 'mousedown');\n\n            const mousemove = dispatchSyntheticEvent(element, 'mousemove');\n\n            expect(mousemove.defaultPrevented).to.be.equal(true);\n          });\n        });\n\n        suite('prevent-handled', () => {\n          setup(() => {\n            controls.applyOptions({eventHandlingBehavior: 'prevent-handled'});\n          });\n\n          test('does not cancel unhandled UI events', () => {\n            dispatchSyntheticEvent(element, 'mousedown');\n\n            const mousemove = dispatchSyntheticEvent(element, 'mousemove');\n\n            expect(mousemove.defaultPrevented).to.be.equal(false);\n          });\n        });\n      });\n\n      suite('interaction policy', () => {\n        suite('allow-when-focused', () => {\n          setup(() => {\n            controls.applyOptions({interactionPolicy: 'allow-when-focused'});\n            settleControls(controls);\n          });\n\n          test('does not zoom when scrolling while blurred', () => {\n            const radius = controls.getCameraSpherical().radius;\n            expect(controls.getFieldOfView())\n                .to.be.closeTo(DEFAULT_OPTIONS.maximumFieldOfView!, 0.00001);\n\n            dispatchSyntheticEvent(element, 'wheel', {deltaY: -1});\n\n            settleControls(controls);\n\n            expect(controls.getCameraSpherical().radius).to.be.equal(radius);\n            expect(controls.getFieldOfView())\n                .to.be.closeTo(DEFAULT_OPTIONS.maximumFieldOfView!, 0.00001);\n          });\n\n          test('does not orbit when pointing while blurred', () => {\n            const originalPhi = controls.getCameraSpherical().phi;\n\n            dispatchSyntheticEvent(\n                element, 'mousedown', {clientX: 0, clientY: 10});\n            dispatchSyntheticEvent(\n                element, 'mousemove', {clientX: 0, clientY: 0});\n\n            expect(controls.getCameraSpherical().phi).to.be.equal(originalPhi);\n          });\n\n          test('does zoom when scrolling while focused', () => {\n            expect(controls.getFieldOfView())\n                .to.be.closeTo(DEFAULT_OPTIONS.maximumFieldOfView!, 0.00001);\n\n            element.focus();\n\n            dispatchSyntheticEvent(element, 'wheel', {deltaY: -1});\n\n            settleControls(controls);\n\n            expect(controls.getFieldOfView())\n                .to.be.lessThan(DEFAULT_OPTIONS.maximumFieldOfView!);\n          });\n        });\n\n        suite('always-allow', () => {\n          setup(() => {\n            controls.applyOptions({interactionPolicy: 'always-allow'});\n            settleControls(controls);\n          });\n\n          test('orbits when pointing, even while blurred', () => {\n            const originalPhi = controls.getCameraSpherical().phi;\n\n            dispatchSyntheticEvent(\n                element, 'mousedown', {clientX: 0, clientY: 10});\n            dispatchSyntheticEvent(\n                element, 'mousemove', {clientX: 0, clientY: 0});\n\n            settleControls(controls);\n\n            expect(controls.getCameraSpherical().phi)\n                .to.be.greaterThan(originalPhi);\n          });\n\n          test('zooms when scrolling, even while blurred', () => {\n            expect(controls.getFieldOfView())\n                .to.be.closeTo(DEFAULT_OPTIONS.maximumFieldOfView!, 0.00001);\n\n            dispatchSyntheticEvent(element, 'wheel', {deltaY: -1});\n\n            settleControls(controls);\n\n            expect(controls.getFieldOfView())\n                .to.be.lessThan(DEFAULT_OPTIONS.maximumFieldOfView!);\n          });\n        });\n\n        suite('events', () => {\n          test('dispatches \"change\" on user interaction', () => {\n            let didCall = false;\n            let changeSource;\n\n            controls.addEventListener('change', ({source}) => {\n              didCall = true;\n              changeSource = source;\n            });\n\n            dispatchSyntheticEvent(element, 'keydown', {keyCode: KeyCode.UP});\n            settleControls(controls);\n\n            expect(didCall).to.be.true;\n            expect(changeSource).to.equal(USER_INTERACTION_CHANGE_SOURCE);\n          });\n\n          test('dispatches \"change\" on direct orbit change', () => {\n            let didCall = false;\n            let changeSource;\n\n            controls.addEventListener('change', ({source}) => {\n              didCall = true;\n              changeSource = source;\n            });\n\n            controls.setOrbit(33, 33, 33);\n            settleControls(controls);\n\n            expect(didCall).to.be.true;\n            expect(changeSource).to.equal(DEFAULT_INTERACTION_CHANGE_SOURCE);\n          });\n\n          test('sends \"user-interaction\" multiple times', () => {\n            const expectedSources = [\n              USER_INTERACTION_CHANGE_SOURCE,\n              USER_INTERACTION_CHANGE_SOURCE,\n              USER_INTERACTION_CHANGE_SOURCE,\n              USER_INTERACTION_CHANGE_SOURCE,\n            ];\n            let changeSource: Array<string> = [];\n\n            controls.addEventListener('change', ({source}) => {\n              changeSource.push(source);\n            });\n\n            dispatchSyntheticEvent(element, 'keydown', {keyCode: KeyCode.UP});\n            controls.update(performance.now(), ONE_FRAME_DELTA);\n            controls.update(performance.now(), ONE_FRAME_DELTA);\n            controls.update(performance.now(), ONE_FRAME_DELTA);\n\n            expect(changeSource).to.eql(expectedSources);\n          });\n\n          test('does not send \"user-interaction\" after setOrbit', () => {\n            const expectedSources = [\n              USER_INTERACTION_CHANGE_SOURCE,\n              USER_INTERACTION_CHANGE_SOURCE,\n              USER_INTERACTION_CHANGE_SOURCE,\n              DEFAULT_INTERACTION_CHANGE_SOURCE,\n              DEFAULT_INTERACTION_CHANGE_SOURCE,\n            ];\n            let changeSource: Array<string> = [];\n\n            controls.addEventListener('change', ({source}) => {\n              changeSource.push(source);\n            });\n\n            dispatchSyntheticEvent(element, 'keydown', {keyCode: KeyCode.UP});\n\n            controls.update(performance.now(), ONE_FRAME_DELTA);\n            controls.update(performance.now(), ONE_FRAME_DELTA);\n\n            controls.setOrbit(3, 3, 3);\n\n            controls.update(performance.now(), ONE_FRAME_DELTA);\n            controls.update(performance.now(), ONE_FRAME_DELTA);\n\n            expect(changeSource).to.eql(expectedSources);\n          });\n\n          suite('simultaneous user and imperative interaction', () => {\n            test('reports source as user interaction', async () => {\n              const eventDispatches = waitForEvent(controls, 'change');\n              controls.adjustOrbit(1, 1, 1, 1);\n              dispatchSyntheticEvent(element, 'keydown', {keyCode: KeyCode.UP});\n              settleControls(controls);\n\n              const event: any = await eventDispatches;\n              expect(event.source).to.be.equal(ChangeSource.USER_INTERACTION);\n            });\n          });\n        });\n      });\n    });\n  });\n});\n"]}