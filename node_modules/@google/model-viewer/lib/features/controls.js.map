{"version":3,"file":"controls.js","sourceRoot":"","sources":["../../src/features/controls.ts"],"names":[],"mappings":"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","sourcesContent":["/* @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {property} from 'lit-element';\nimport {Event, PerspectiveCamera, Spherical, Vector3} from 'three';\n\nimport {style} from '../decorators.js';\nimport ModelViewerElementBase, {$ariaLabel, $loadedTime, $needsRender, $onModelLoad, $onResize, $scene, $tick} from '../model-viewer-base.js';\nimport {normalizeUnit} from '../styles/conversions.js';\nimport {EvaluatedStyle, Intrinsics, SphericalIntrinsics, Vector3Intrinsics} from '../styles/evaluators.js';\nimport {IdentNode, NumberNode, numberNode, parseExpressions} from '../styles/parsers.js';\nimport {DEFAULT_FOV_DEG} from '../three-components/Model.js';\nimport {ChangeEvent, ChangeSource, SmoothControls} from '../three-components/SmoothControls.js';\nimport {Constructor} from '../utilities.js';\nimport {timeline} from '../utilities/animation.js';\n\n// NOTE(cdata): The following \"animation\" timing functions are deliberately\n// being used in favor of CSS animations. In Safari 12.1 and 13, CSS animations\n// would cause the interaction prompt to glitch unexpectedly\n// @see https://github.com/GoogleWebComponents/model-viewer/issues/839\nconst PROMPT_ANIMATION_TIME = 5000;\n\n// For timing purposes, a \"frame\" is a timing agnostic relative unit of time\n// and a \"value\" is a target value for the keyframe.\nconst wiggle = timeline(0, [\n  {frames: 6, value: 0},\n  {frames: 5, value: -1},\n  {frames: 1, value: -1},\n  {frames: 8, value: 1},\n  {frames: 1, value: 1},\n  {frames: 5, value: 0},\n  {frames: 12, value: 0}\n]);\n\nconst fade = timeline(0, [\n  {frames: 2, value: 0},\n  {frames: 1, value: 1},\n  {frames: 5, value: 1},\n  {frames: 1, value: 0},\n  {frames: 4, value: 0}\n]);\n\nexport interface CameraChangeDetails {\n  source: ChangeSource;\n}\n\nexport interface SphericalPosition {\n  theta: number;  // equator angle around the y (up) axis.\n  phi: number;    // polar angle from the y (up) axis.\n  radius: number;\n}\n\nexport type InteractionPromptStrategy = 'auto'|'when-focused'|'none';\nexport type InteractionPromptStyle = 'basic'|'wiggle';\nexport type InteractionPolicy = 'always-allow'|'allow-when-focused';\n\nexport const InteractionPromptStrategy:\n    {[index: string]: InteractionPromptStrategy} = {\n      AUTO: 'auto',\n      WHEN_FOCUSED: 'when-focused',\n      NONE: 'none'\n    };\n\nexport const InteractionPromptStyle:\n    {[index: string]: InteractionPromptStyle} = {\n      BASIC: 'basic',\n      WIGGLE: 'wiggle'\n    };\n\nexport const InteractionPolicy: {[index: string]: InteractionPolicy} = {\n  ALWAYS_ALLOW: 'always-allow',\n  WHEN_FOCUSED: 'allow-when-focused'\n};\n\nexport const DEFAULT_CAMERA_ORBIT = '0deg 75deg 105%';\nconst DEFAULT_CAMERA_TARGET = 'auto auto auto';\nconst DEFAULT_FIELD_OF_VIEW = 'auto';\n\nexport const fieldOfViewIntrinsics = (element: ModelViewerElementBase) => {\n  return {\n    basis: [numberNode(\n        (element as any)[$zoomAdjustedFieldOfView] * Math.PI / 180, 'rad')],\n    keywords: {auto: [null]}\n  };\n};\n\nexport const cameraOrbitIntrinsics = (() => {\n  const defaultTerms =\n      parseExpressions(DEFAULT_CAMERA_ORBIT)[0]\n          .terms as [NumberNode<'rad'>, NumberNode<'rad'>, IdentNode];\n\n  const theta = normalizeUnit(defaultTerms[0]) as NumberNode<'rad'>;\n  const phi = normalizeUnit(defaultTerms[1]) as NumberNode<'rad'>;\n\n  return (element: ModelViewerElementBase) => {\n    const radius = element[$scene].model.idealCameraDistance;\n\n    return {\n      basis: [theta, phi, numberNode(radius, 'm')],\n      keywords: {auto: [null, null, numberNode(105, '%')]}\n    };\n  };\n})();\n\nexport const cameraTargetIntrinsics = (element: ModelViewerElementBase) => {\n  const center = element[$scene].model.boundingBox.getCenter(new Vector3);\n\n  return {\n    basis: [\n      numberNode(center.x, 'm'),\n      numberNode(center.y, 'm'),\n      numberNode(center.z, 'm')\n    ],\n    keywords: {auto: [null, null, null]}\n  };\n};\n\nconst HALF_FIELD_OF_VIEW_RADIANS = (DEFAULT_FOV_DEG / 2) * Math.PI / 180;\nconst HALF_PI = Math.PI / 2.0;\nconst THIRD_PI = Math.PI / 3.0;\nconst QUARTER_PI = HALF_PI / 2.0;\nconst PHI = 2.0 * Math.PI;\n\nconst AZIMUTHAL_QUADRANT_LABELS = ['front', 'right', 'back', 'left'];\nconst POLAR_TRIENT_LABELS = ['upper-', '', 'lower-'];\n\nexport const DEFAULT_INTERACTION_PROMPT_THRESHOLD = 3000;\nexport const INTERACTION_PROMPT =\n    'Use mouse, touch or arrow keys to control the camera!';\n\nexport const $controls = Symbol('controls');\nexport const $promptElement = Symbol('promptElement');\nexport const $promptAnimatedContainer = Symbol('promptAnimatedContainer');\nexport const $idealCameraDistance = Symbol('idealCameraDistance');\nconst $framedFieldOfView = Symbol('framedFieldOfView');\n\nconst $deferInteractionPrompt = Symbol('deferInteractionPrompt');\nconst $updateAria = Symbol('updateAria');\nconst $updateCamera = Symbol('updateCamera');\n\nconst $blurHandler = Symbol('blurHandler');\nconst $focusHandler = Symbol('focusHandler');\nconst $changeHandler = Symbol('changeHandler');\n\nconst $onBlur = Symbol('onBlur');\nconst $onFocus = Symbol('onFocus');\nconst $onChange = Symbol('onChange');\n\nconst $shouldPromptUserToInteract = Symbol('shouldPromptUserToInteract');\nconst $waitingToPromptUser = Symbol('waitingToPromptUser');\nconst $userPromptedOnce = Symbol('userPromptedOnce');\nconst $promptElementVisibleTime = Symbol('promptElementVisibleTime');\nconst $lastPromptOffset = Symbol('lastPromptOffset');\nconst $focusedTime = Symbol('focusedTime');\n\nconst $zoomAdjustedFieldOfView = Symbol('zoomAdjustedFieldOfView');\nconst $lastSpherical = Symbol('lastSpherical');\nconst $jumpCamera = Symbol('jumpCamera');\n\nconst $syncCameraOrbit = Symbol('syncCameraOrbit');\nconst $syncFieldOfView = Symbol('syncFieldOfView');\nconst $syncCameraTarget = Symbol('syncCameraTarget');\n\nexport interface ControlsInterface {\n  cameraControls: boolean;\n  cameraOrbit: string;\n  cameraTarget: string;\n  fieldOfView: string;\n  interactionPrompt: InteractionPromptStrategy;\n  interactionPromptStyle: InteractionPromptStyle;\n  interactionPolicy: InteractionPolicy;\n  interactionPromptThreshold: number;\n  getCameraOrbit(): SphericalPosition;\n  getCameraTarget(): Vector3;\n  getFieldOfView(): number;\n  jumpCameraToGoal(): void;\n}\n\nexport const ControlsMixin = <T extends Constructor<ModelViewerElementBase>>(\n    ModelViewerElement: T): Constructor<ControlsInterface>&T => {\n  class ControlsModelViewerElement extends ModelViewerElement {\n    @property({type: Boolean, attribute: 'camera-controls'})\n    cameraControls: boolean = false;\n\n    @style({\n      intrinsics: cameraOrbitIntrinsics,\n      observeEffects: true,\n      updateHandler: $syncCameraOrbit\n    })\n    @property({type: String, attribute: 'camera-orbit', hasChanged: () => true})\n    cameraOrbit: string = DEFAULT_CAMERA_ORBIT;\n\n    @style({\n      intrinsics: cameraTargetIntrinsics,\n      observeEffects: true,\n      updateHandler: $syncCameraTarget\n    })\n    @property(\n        {type: String, attribute: 'camera-target', hasChanged: () => true})\n    cameraTarget: string = DEFAULT_CAMERA_TARGET;\n\n    @style({\n      intrinsics: fieldOfViewIntrinsics,\n      observeEffects: true,\n      updateHandler: $syncFieldOfView\n    })\n    @property(\n        {type: String, attribute: 'field-of-view', hasChanged: () => true})\n    fieldOfView: string = DEFAULT_FIELD_OF_VIEW;\n\n    @property({type: Number, attribute: 'interaction-prompt-threshold'})\n    interactionPromptThreshold: number = DEFAULT_INTERACTION_PROMPT_THRESHOLD;\n\n    @property({type: String, attribute: 'interaction-prompt-style'})\n    interactionPromptStyle: InteractionPromptStyle =\n        InteractionPromptStyle.WIGGLE;\n\n    @property({type: String, attribute: 'interaction-prompt'})\n    interactionPrompt: InteractionPromptStrategy =\n        InteractionPromptStrategy.AUTO;\n\n    @property({type: String, attribute: 'interaction-policy'})\n    interactionPolicy: InteractionPolicy = InteractionPolicy.ALWAYS_ALLOW;\n\n    protected[$promptElement] =\n        this.shadowRoot!.querySelector('.interaction-prompt') as HTMLElement;\n    protected[$promptAnimatedContainer] =\n        this.shadowRoot!.querySelector(\n            '.interaction-prompt > .animated-container') as HTMLElement;\n\n    protected[$focusedTime] = Infinity;\n    protected[$lastPromptOffset] = 0;\n    protected[$promptElementVisibleTime] = Infinity;\n    protected[$userPromptedOnce] = false;\n    protected[$waitingToPromptUser] = false;\n    protected[$shouldPromptUserToInteract] = true;\n\n    protected[$controls] = new SmoothControls(\n        this[$scene].getCamera() as PerspectiveCamera, this[$scene].canvas);\n\n    protected[$framedFieldOfView]: number|null = null;\n    protected[$zoomAdjustedFieldOfView]: number = DEFAULT_FOV_DEG;\n    protected[$lastSpherical] = new Spherical();\n    protected[$jumpCamera] = false;\n\n    protected[$changeHandler] = (event: Event) =>\n        this[$onChange](event as ChangeEvent);\n\n    protected[$focusHandler] = () => this[$onFocus]();\n    protected[$blurHandler] = () => this[$onBlur]();\n\n    getCameraOrbit(): SphericalPosition {\n      const {theta, phi, radius} = this[$lastSpherical];\n      return {theta, phi, radius};\n    }\n\n    getCameraTarget(): Vector3 {\n      return this[$controls].getTarget();\n    }\n\n    getFieldOfView(): number {\n      return this[$controls].getFieldOfView();\n    }\n\n    jumpCameraToGoal() {\n      this[$jumpCamera] = true;\n      this.requestUpdate($jumpCamera, false);\n    }\n\n    connectedCallback() {\n      super.connectedCallback();\n\n      this[$controls].addEventListener('change', this[$changeHandler]);\n    }\n\n    disconnectedCallback() {\n      super.disconnectedCallback();\n\n      this[$controls].removeEventListener('change', this[$changeHandler]);\n    }\n\n    updated(changedProperties: Map<string|number|symbol, unknown>) {\n      super.updated(changedProperties);\n\n      const controls = this[$controls];\n      const scene = (this as any)[$scene];\n\n      if (changedProperties.has('cameraControls')) {\n        if (this.cameraControls) {\n          controls.enableInteraction();\n          if (this.interactionPrompt === InteractionPromptStrategy.AUTO) {\n            this[$waitingToPromptUser] = true;\n          }\n\n          scene.canvas.addEventListener('focus', this[$focusHandler]);\n          scene.canvas.addEventListener('blur', this[$blurHandler]);\n        } else {\n          scene.canvas.removeEventListener('focus', this[$focusHandler]);\n          scene.canvas.removeEventListener('blur', this[$blurHandler]);\n\n          controls.disableInteraction();\n          this[$deferInteractionPrompt]();\n        }\n      }\n\n      if (changedProperties.has('interactionPrompt') ||\n          changedProperties.has('cameraControls') ||\n          changedProperties.has('src')) {\n        if (this.interactionPrompt === InteractionPromptStrategy.AUTO &&\n            this.cameraControls) {\n          this[$waitingToPromptUser] = true;\n        } else {\n          this[$deferInteractionPrompt]();\n        }\n      }\n\n      if (changedProperties.has('interactionPromptStyle')) {\n        this[$promptElement].classList.toggle(\n            'wiggle',\n            this.interactionPromptStyle === InteractionPromptStyle.WIGGLE);\n      }\n\n      if (changedProperties.has('interactionPolicy')) {\n        const interactionPolicy = this.interactionPolicy;\n        controls.applyOptions({interactionPolicy});\n      }\n\n      if (this[$jumpCamera] === true) {\n        Promise.resolve().then(() => {\n          this[$controls].jumpToGoal();\n          this[$jumpCamera] = false;\n        });\n      }\n    }\n\n    [$syncFieldOfView](style: EvaluatedStyle<Intrinsics<['rad']>>) {\n      this[$controls].setFieldOfView(style[0] * 180 / Math.PI);\n    }\n\n    [$syncCameraOrbit](style: EvaluatedStyle<SphericalIntrinsics>) {\n      this[$controls].setOrbit(style[0], style[1], style[2]);\n    }\n\n    [$syncCameraTarget](style: EvaluatedStyle<Vector3Intrinsics>) {\n      const [x, y, z] = style;\n      const scene = this[$scene];\n      this[$controls].setTarget(x, y, z);\n      // TODO(#837): Mutating scene.pivotCenter should automatically adjust\n      // pivot rotation\n      scene.pivotCenter.set(x, y, z);\n      scene.setPivotRotation(scene.getPivotRotation());\n    }\n\n    [$tick](time: number, delta: number) {\n      super[$tick](time, delta);\n\n      if (this[$waitingToPromptUser] &&\n          this.interactionPrompt !== InteractionPromptStrategy.NONE) {\n        const thresholdTime =\n            this.interactionPrompt === InteractionPromptStrategy.AUTO ?\n            this[$loadedTime] :\n            this[$focusedTime];\n\n        if (this.loaded &&\n            time > thresholdTime + this.interactionPromptThreshold) {\n          this[$scene].canvas.setAttribute('aria-label', INTERACTION_PROMPT);\n\n          // NOTE(cdata): After notifying users that the controls are\n          // available, we flag that the user has been prompted at least\n          // once, and then effectively stop the idle timer. If the camera\n          // orbit changes after this point, the user will never be prompted\n          // again for this particular <model-element> instance:\n          this[$userPromptedOnce] = true;\n          this[$waitingToPromptUser] = false;\n          this[$promptElementVisibleTime] = time;\n\n          this[$promptElement].classList.add('visible');\n        }\n      }\n\n\n      if (isFinite(this[$promptElementVisibleTime]) &&\n          this.interactionPromptStyle === InteractionPromptStyle.WIGGLE) {\n        const scene = this[$scene];\n        const animationTime =\n            ((time - this[$promptElementVisibleTime]) / PROMPT_ANIMATION_TIME) %\n            1;\n        const offset = wiggle(animationTime);\n        const opacity = fade(animationTime);\n\n        const xOffset = offset * scene.width * 0.05;\n        const deltaTheta = (offset - this[$lastPromptOffset]) * Math.PI / 16;\n\n        this[$promptAnimatedContainer].style.transform =\n            `translateX(${xOffset}px)`;\n        this[$promptAnimatedContainer].style.opacity = `${opacity}`;\n\n        this[$controls].adjustOrbit(deltaTheta, 0, 0, 0);\n\n        this[$lastPromptOffset] = offset;\n        this[$needsRender]();\n      }\n\n      this[$controls].update(time, delta);\n      const target = this.getCameraTarget();\n      if (!this[$scene].pivotCenter.equals(target)) {\n        this[$scene].pivotCenter.copy(target);\n        this[$scene].setPivotRotation(this[$scene].getPivotRotation());\n      }\n    }\n\n    [$deferInteractionPrompt]() {\n      // Effectively cancel the timer waiting for user interaction:\n      this[$waitingToPromptUser] = false;\n      this[$promptElement].classList.remove('visible');\n      this[$promptElementVisibleTime] = Infinity;\n\n      // Implicitly there was some reason to defer the prompt. If the user\n      // has been prompted at least once already, we no longer need to\n      // prompt the user, although if they have never been prompted we\n      // should probably prompt them at least once just in case.\n      if (this[$userPromptedOnce]) {\n        this[$shouldPromptUserToInteract] = false;\n      }\n    }\n\n    /**\n     * Set the camera's radius and field of view to properly frame the scene\n     * based on changes to the model or aspect ratio, and maintains the\n     * relative camera zoom state.\n     */\n    [$updateCamera]() {\n      const controls = this[$controls];\n      const {aspect} = this[$scene];\n      const {idealCameraDistance, fieldOfViewAspect} = this[$scene].model;\n\n      const maximumRadius = idealCameraDistance * 2;\n      controls.applyOptions({maximumRadius});\n\n      const modelRadius =\n          idealCameraDistance * Math.sin(HALF_FIELD_OF_VIEW_RADIANS);\n      const near = 0;\n      const far = maximumRadius + modelRadius;\n\n      controls.updateIntrinsics(near, far, aspect);\n\n      if (this.fieldOfView === DEFAULT_FIELD_OF_VIEW) {\n        const zoom = (this[$framedFieldOfView] != null) ?\n            controls.getFieldOfView() / this[$framedFieldOfView]! :\n            1;\n\n        const vertical = Math.tan(HALF_FIELD_OF_VIEW_RADIANS) *\n            Math.max(1, fieldOfViewAspect / aspect);\n        this[$framedFieldOfView] = 2 * Math.atan(vertical) * 180 / Math.PI;\n\n        const maximumFieldOfView = this[$framedFieldOfView]!;\n        controls.applyOptions({maximumFieldOfView});\n        // TODO(#835): Move computation of this value to Model or ModelScene\n        this[$zoomAdjustedFieldOfView] = this[$framedFieldOfView]! * zoom;\n        this.requestUpdate('fieldOfView', this.fieldOfView);\n      }\n\n      controls.jumpToGoal();\n    }\n\n    [$updateAria]() {\n      // NOTE(cdata): It is possible that we might want to record the\n      // last spherical when the label actually changed. Right now, the\n      // side-effect the current implementation is that we will only\n      // announce the first view change that occurs after the element\n      // becomes focused.\n      const {theta: lastTheta, phi: lastPhi} = this[$lastSpherical];\n      const {theta, phi} =\n          this[$controls]!.getCameraSpherical(this[$lastSpherical]);\n\n      const rootNode = this.getRootNode() as Document | ShadowRoot | null;\n\n      // Only change the aria-label if <model-viewer> is currently focused:\n      if (rootNode != null && rootNode.activeElement === this) {\n        const lastAzimuthalQuadrant =\n            (4 + Math.floor(((lastTheta % PHI) + QUARTER_PI) / HALF_PI)) % 4;\n        const azimuthalQuadrant =\n            (4 + Math.floor(((theta % PHI) + QUARTER_PI) / HALF_PI)) % 4;\n\n        const lastPolarTrient = Math.floor(lastPhi / THIRD_PI);\n        const polarTrient = Math.floor(phi / THIRD_PI);\n\n        if (azimuthalQuadrant !== lastAzimuthalQuadrant ||\n            polarTrient !== lastPolarTrient) {\n          const {canvas} = (this as any)[$scene];\n          const azimuthalQuadrantLabel =\n              AZIMUTHAL_QUADRANT_LABELS[azimuthalQuadrant];\n          const polarTrientLabel = POLAR_TRIENT_LABELS[polarTrient];\n\n          const ariaLabel =\n              `View from stage ${polarTrientLabel}${azimuthalQuadrantLabel}`;\n\n          canvas.setAttribute('aria-label', ariaLabel);\n        }\n      }\n    }\n\n    [$onResize](event: any) {\n      super[$onResize](event);\n      this[$updateCamera]();\n    }\n\n    [$onModelLoad](event: any) {\n      super[$onModelLoad](event);\n      this[$updateCamera]();\n      this.requestUpdate('cameraOrbit', this.cameraOrbit);\n      this.requestUpdate('cameraTarget', this.cameraTarget);\n      this[$controls].jumpToGoal();\n    }\n\n    [$onFocus]() {\n      const {canvas} = (this as any)[$scene];\n\n      if (!isFinite(this[$focusedTime])) {\n        this[$focusedTime] = performance.now();\n      }\n\n      // NOTE(cdata): On every re-focus, we switch the aria-label back to\n      // the original, non-prompt label if appropriate. If the user has\n      // already interacted, they no longer need to hear the prompt.\n      // Otherwise, they will hear it again after the idle prompt threshold\n      // has been crossed.\n      const ariaLabel = this[$ariaLabel];\n\n      if (canvas.getAttribute('aria-label') !== ariaLabel) {\n        canvas.setAttribute('aria-label', ariaLabel);\n      }\n\n      // NOTE(cdata): When focused, if the user has yet to interact with the\n      // camera controls (that is, we \"should\" prompt the user), we begin\n      // the idle timer and indicate that we are waiting for it to cross the\n      // prompt threshold:\n      if (!isFinite(this[$promptElementVisibleTime]) &&\n          this[$shouldPromptUserToInteract]) {\n        this[$waitingToPromptUser] = true;\n      }\n    }\n\n    [$onBlur]() {\n      this[$waitingToPromptUser] = false;\n      this[$promptElement].classList.remove('visible');\n\n      this[$promptElementVisibleTime] = Infinity;\n      this[$focusedTime] = Infinity;\n    }\n\n    [$onChange]({source}: ChangeEvent) {\n      this[$updateAria]();\n      this[$needsRender]();\n\n      if (source === ChangeSource.USER_INTERACTION) {\n        this[$deferInteractionPrompt]();\n      }\n\n      this.dispatchEvent(new CustomEvent<CameraChangeDetails>(\n          'camera-change', {detail: {source}}));\n    }\n  }\n\n  return ControlsModelViewerElement;\n};\n"]}